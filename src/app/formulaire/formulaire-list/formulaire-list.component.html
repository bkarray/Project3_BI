<div class="container">
  <div class="sevBtnSpace">
    <a class="myButton" (click)="openServList()">Serv</a>
  </div>
  
    <table>
        <tbody class="blueTable" *ngFor="let formulaire of formulaires;let index=index">
        <tr>
            <td (click)="openFormPage(formulaire.Formulaire_Id)">{{formulaire.Formulaire_Name}}</td>
            <td></td>
            <td></td>
            <td class="cancelIcon" (click)="opendeleteForm(formulaire.Formulaire_Id,formulaire.Formulaire_Name)"><span class="material-symbols-outlined">
              cancel
              </span></td>
           
            <td><a class="d-flex justify-content-end" (click)="open(index)">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-caret-down"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M3.204 5h9.592L8 10.481 3.204 5zm-.753.659 4.796 5.48a1 1 0 0 0 1.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 0 0-.753 1.659z"
                  />
                </svg>
              </a></td>

            
        </tr>
        <tr *ngIf="formulaire.isOpen"> 
        <td colspan="5">
            <tr *ngFor="let reponse of formulaire.reponses;let indexR=index" class="boder"> 
                <td ><a  class="myButton"  (click)="openTable(formulaire.Formulaire_Id,reponse.Reponse_Id)">open</a></td>
                <td (click)="openReponseFormPage(index,indexR)">{{reponse.reponse_Name}}</td>
                <td><p *ngIf="reponse.reponse_level!=null">etape n°{{reponse.currentServ.Serv_order}}</p> 
                <p *ngIf="reponse.reponse_level==null">reponse est executé </p></td>
                <td><p *ngIf="reponse.reponse_level!=null">{{reponse.currentServ.Serv_Name}}</p></td>
                <td><p *ngIf="reponse.reponse_level!=null">{{reponse.currentServ.userName}}</p></td>
                
    
            </tr>
            <tr *ngIf="isAdmin">
                <td></td>
                <td></td>
                <td><input *ngIf="reponseFormIsOpen"  type="text" placeholder="Reponse Name..." [(ngModel)]="newReponseName"></td>
                <td><a *ngIf="reponseFormIsOpen"  class="myButton" (click)="addNewReponse(formulaire.Formulaire_Id)">confirmer</a></td>
                <td><a *ngIf="!reponseFormIsOpen" class="myButton" (click)="openReponseForm()">+</a></td>
    
            </tr>
        </td>
    </tr>
    

        </tbody>
    </table>
    <div class="d-flex justify-content-end">
        <button class="btn btn-warning mt-3" (click)="openForm()"  *ngIf="isAdmin">
          <i class="fa fa-chevron-right"></i> create formulaire
        </button>    
      </div>
<div class="listItems" *ngIf="creatFormIsOpen">
    <i (click)="closeForm()" class="material-icons close">
        close
      </i>
    <p>New Formulaire name:</p>
    <input type="text" [(ngModel)]="newFormulaireName">
    <p>New Formulaire description:</p>
    <input type="text" [(ngModel)]="newFormulaireStatus">
    <br>
    <p>services:</p>
    <div style="padding-left: 35%;">
     <table style="width: 50% ;">
      <tr *ngFor="let serv of servsExamples;let index=index" >
        <td>{{serv.Serv_Name}}</td>
        <td><input type="checkbox" [(ngModel)]="serv.isAdded" (change)="addOrRemoveServ(index)"></td>
      </tr>
      <tr>
        
        <td><a class="myButton" (click)="goToCreatServForm()" >+</a></td>
        <td></td>
      </tr>
     </table>
    </div>
    <button href="#" class="btn btn-warning mt-3" (click)="addNewFormulaire()">
        <i class="fa fa-chevron-right" ></i> Create Formulaire
      </button>
</div>

<div class="listItems" *ngIf="todelete">
  <h3>are you sur to delete {{deleteFormName}}!?</h3>
  <br>
  <br>
  <br>
  <br>
  <br>
  <a class="myButton" (click)="opendeleteForm(null,'')">cancel</a>
  <a class="myButton" (click)="deleteFormulaire()">yes</a>
  
</div>
 <div class="listItems" *ngIf="servFormIsOpen">
  <h3>new Service</h3>
  <br>
  <br>
  <input type="text" placeholder="New Serv Name..." [(ngModel)]="servToCreate">
  <br>
  <br>
  <h5>Users:</h5>
  <p *ngFor="let user of usersNewServ;let index=index">{{user.U_FirstName}}  {{user.U_LastName}}<i class="material-icons"(click)="deleteUser(index)" >close</i></p>
  <a *ngIf="!userForm" (click)="addUserForm()" class="myButton">+</a>
  <select *ngIf="userForm" [(ngModel)]="newUserId">
    <option value="0">choisir un utilisateur</option>
    <option *ngFor="let user of users" value="{{user.U_Id}}">{{user.U_FirstName}}  {{user.U_LastName}}</option>
  </select>
  <a *ngIf="userForm" (click)="addUser()" class="myButton">confirme</a>

<br>
<br>

  <a class="myButton" (click)="closeServForm()">cancel</a>
  <a class="myButton" (click)="creatServ()">create</a>

</div> 
<div *ngIf="servList" class="listItems">
  <i (click)="openServList()" class="material-icons close">
    close
  </i>
  <br>
<h3>les services</h3>
<br>

<ul>
  <li *ngFor="let serv of servsExamples;let index=index" (click)="openServShow(index)"> {{serv.Serv_Name}}<span (click)="deleteServ(index)" class="material-symbols-outlined deleteServ">
    cancel
    </span></li>
</ul>
<a class="myButton" (click)="addServForm()">+</a>
</div>
 <div class="listItems" *ngIf="servShowIsOpen">
  <br>
  <h3>{{servToShow}}</h3>
  <br>

  <br>
  <h5>Users:</h5>
  <p *ngFor="let user of usersOfServToShow;let index=index">{{user.U_FirstName}}  {{user.U_LastName}}<i class="material-icons"(click)="deleteUserShow(index)" >close</i></p>
  <a *ngIf="!userFormShow" (click)="openUserFormShow()" class="myButton">+</a>
  <br>
  <select *ngIf="userFormShow" [(ngModel)]="newUserId">
    <option value="0">choisir un utilisateur</option>
    <option *ngFor="let user of usersToAddShow" value="{{user.U_Id}}">{{user.U_FirstName}}  {{user.U_LastName}}</option>
  </select>
  <br>
  <br>
  <a *ngIf="userFormShow" (click)="closeUserFormShow()" class="myButton">cancel</a>
  <a *ngIf="userFormShow" (click)="addUserShow()" class="myButton">confirme</a>

<br>
<br>

  <a class="myButton" (click)="closeServShow()">return</a>

</div>
</div>
